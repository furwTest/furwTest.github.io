<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<title>百度地图 </title>
		<script src="js/jquery-2.1.0.js"></script>
		<!--引用百度API-->
		<script src="http://api.map.baidu.com/api?v=2.0&ak=IvBjpxT0GRidmqjDhGMFcQU6"></script>
		<script src="http://api.map.baidu.com/library/SearchInfoWindow/1.5/src/SearchInfoWindow_min.js"></script>
		<link rel="stylesheet" href="http://api.map.baidu.com/library/SearchInfoWindow/1.5/src/SearchInfoWindow_min.css" />
		<!--外部样式表-->
		<link rel="stylesheet" href="css/index.css" />
	</head>

	<body>
		<!--地图容器-->
		<div id="allmap"></div>

		<script src="js/index.js"></script>
		<script>
			var names = 1;
			var addresss = 1;
			//打开数据库 如果数据库 不存在将创建数据库
			var dataBase = openDatabase("sales_address", "1.0", "店铺位置表", 1024 * 1024);
			//创建表
			dataBase.transaction(function(tx) {
				tx.executeSql('CREATE TABLE IF NOT EXISTS LOGS (name unique, lon, lat, address)');
			});
			//添加默认数据
			dataBase.transaction(function(tx) {
				tx.executeSql('INSERT INTO LOGS (name, lon, lat ,address) VALUES ("店铺 A", 116.277854 , 39.931988, "地址：北京市东城区王府井大街88号乐天银泰百货八层")');
				tx.executeSql('INSERT INTO LOGS (name, lon, lat ,address) VALUES ("店铺 B", 116.266605 , 39.931585, "地址：北京市东城区东华门大街")');
				tx.executeSql('INSERT INTO LOGS (name, lon, lat ,address) VALUES ("店铺 C", 116.292222 , 39.932345, "地址：北京市东城区正义路甲5号S")');
			});
			// 创建地图容器
			map = new BMap.Map("allmap");
			// GPS定位	需要打开电脑定位， 并且需要打开Wi-Fi
			var geolocation = new BMap.Geolocation();
			var a;
			var b;
			geolocation.getCurrentPosition(function(r) {
				if (this.getStatus() == BMAP_STATUS_SUCCESS) {
					var mk = new BMap.Marker(r.point);
					map.addOverlay(mk);
					map.panTo(r.point);
					a = r.point.lng
					b = r.point.lat
				} else {
					alert('failed' + this.getStatus());
				}
			}, {
				enableHighAccuracy: true
			}); //定位结束
			//初始化 并且设置地图现实 级别
			var point = new BMap.Point(a, b);
			map.centerAndZoom(point, 15);
			//启用滚轮放大缩小，默认禁用
			map.enableScrollWheelZoom();
			map.addEventListener("click", function(e) {
				//判断点击的是 地图 还是覆盖物
				if (e.overlay) {
					//覆盖物 不操作
					alert("覆盖物");
				} else {
					alert("地图");
				}
			});
		</script>
	</body>

</html>